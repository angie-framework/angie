<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">src/index.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
</head>
<body class="layout-container">

<header>
  <a href="./">Home</a>
  <a href="identifiers.html">Identifier</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="https://github.com/benderTheCrime/angie.git" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div data-ice="classWrap">
  <h2>Class</h2>
  <ul>
    
  <li data-ice="classDoc"><span><a href="class/src/util/$ExceptionsProvider.js~$$InvalidConfigError.html">$$InvalidConfigError</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/factories/$CacheFactory.js~$CacheFactory.html">$CacheFactory</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/util/$MimeTypeProvider.js~$MimeTypeProvider.html">$MimeTypeProvider</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/services/$Request.js~$Request.html">$Request</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/services/$Responses.js~$Response.html">$Response</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/factories/$RouteProvider.js~$RouteProvider.html">$RouteProvider</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/factories/$TemplateCache.js~$TemplateCache.html">$TemplateCache</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/factories/$Compile.js~$window.html">$window</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/Angie.js~Angie.html">Angie</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/services/BaseRequest.js~BaseRequest.html">BaseRequest</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/Config.js~Config.html">Config</a></span></li>
</ul>
</div>



<div data-ice="functionWrap">
  <h2><a href="function/">Function</a></h2>
  <ul>
    
  <li data-ice="functionDoc"><span><a href="function/index.html#static-function-Base">Base</a></span></li>
<li data-ice="functionDoc"><span><a href="function/index.html#static-function-shell">shell</a></span></li>
<li data-ice="functionDoc"><span><a href="function/index.html#static-function-watch">watch</a></span></li>
</ul>
</div>






</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/index.js</h1>
<pre class="source-code line-number"><code class="prettyprint linenums" data-ice="content">/**
 * @module index.js
 * @author Joe Groseclose &lt;@benderTheCrime&gt;
 * @date 8/16/2015
 */

// Global Modules
import &apos;es6-module-loader&apos;;

// System Modules
import {exec} from                  &apos;child_process&apos;;
import {gray} from                  &apos;chalk&apos;;
import $LogProvider from            &apos;angie-log&apos;;

// Angie Modules
import Config from                  &apos;./Config&apos;;
import $$createProject from         &apos;./util/scaffold/project&apos;;
import {watch, server} from         &apos;./Server&apos;;
import shell from                   &apos;./util/shell&apos;;

// System/Tranform BabelJS options
System.transpiler = &apos;babel&apos;;

const p = process,
    $$server = requiresConfig.bind(null, server),
    $$watch = requiresConfig.bind(null, watch),
    $$shell = requiresConfig.bind(null, shell),
    $$db = requiresConfig.bind(null, require.bind(null, &apos;angie-orm&apos;));
let args = [];


// Remove trivial arguments
p.argv.forEach(function(v) {
    if (!v.match(/(node|iojs|index|angie)/)) {
        args.push(v);
    }
});

// Route the CLI request to a specific command
switch ((args[0] || &apos;&apos;).toLowerCase()) {
    case &apos;help&apos;:
        help();
        break;
    case &apos;server&apos;:
        $$server();
        break;
    case &apos;watch&apos;:
        $$watch();
        break;
    case &apos;s&apos;:
        $$server();
        break;
    case &apos;cluster&apos;:
        break;
    case &apos;createproject&apos;:
        $$createProject({
            name: args[1],
            location: args[2]
        });
        break;
    case &apos;syncdb&apos;:
        $$db();
        break;
    case &apos;migrate&apos;:
        $$db();
        break;
    case &apos;test&apos;:
        runTests();
        break;
    case &apos;shell&apos;:
        $$shell();
        break;
    default:
        $LogProvider.error(&apos;Unrecognized CLI Argument&apos;);
}

// Wrapper function for services which require configs to be loaded
function requiresConfig(fn) {

    // Fetch configs
    return new Config().then(function() {
        return typeof fn === &apos;function&apos; ? fn(args) : args;
    }, function() {
        p.exit(1);
    });
}

function runTests() {

    // TODO is there any way to carry the stream output from gulp instead
    // of capturing stdout?
    exec(`cd ${__dirname} &amp;&amp; gulp`, function(e, std, err) {
        $LogProvider.info(std);
        if (err) {
            $LogProvider.error(err);
        }
        if (e) {
            throw new Error(e);
        }
    });
}

function help() {
    $LogProvider.bold(&apos;Angie&apos;);
    console.log(&apos;A Component-based NodeJS MVC&apos;);
    console.log(&apos;\r&apos;);
    $LogProvider.bold(&apos;Version:&apos;);
    console.log(global.ANGIE_VERSION);
    console.log(&apos;\r&apos;);
    $LogProvider.bold(&apos;Commands:&apos;);
    console.log(
        &apos;server [ port -- optional ]                        &apos; +
        gray(
            &apos;Start the Angie Webserver (shortcut with s). Default port &apos; +
            &apos;is 3000.&apos;
        )
    );
    console.log(
        &apos;cluster [ port -- optional ]                       &apos; +
        gray(&apos;Start the Angie Webserver as a Cluster.&apos;)
    );
    console.log(
        &apos;createProject [ name ] [ location -- optional ]    &apos; +
        gray(
            &apos;Create a new Angie project with the specified name in the &apos; +
            &apos;current directory.&apos;
        )
    );
    console.log(
        &apos;test                                               &apos; +
        gray(
            &apos;Runs the Angie test suite and prints the results in the &apos; +
            &apos;console&apos;
        )
    );
}</code></pre>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.1.2)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
